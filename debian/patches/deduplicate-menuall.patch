Description: Switch to checking GSD version for the build #1319 GNOME 3.24
 Split the monolithic gnome-settings-daemon into individual components. With
 each subsequent release the component list is being reduced; capability is
 being pushed into GNOME Shell itself. Budgie Desktop v10.4.x needs to adapt
 to this forced change by checking the GSD version and compiling those
 components that correspond to the upcoming stable release. This commit
 introduces support for the upcoming GNOME 3.28 release of GSD (beta 3.27.90
 of GSD)
Author: David Mohammed <fossfreedom@ubuntu.com>
Origin: Other
Forwarded: https://github.com/budgie-desktop/budgie-desktop/pull/1336
Last-Update: 2018-02-18
---
 src/session/meson.build | 16 +++++++++++-----
 1 file changed, 11 insertions(+), 5 deletions(-)

Index: budgie-desktop-10.4+git20171031.10.g9f71bb8/src/applets/budgie-menu/BudgieMenuWindow.vala
===================================================================
--- budgie-desktop-10.4+git20171031.10.g9f71bb8.orig/src/applets/budgie-menu/BudgieMenuWindow.vala
+++ budgie-desktop-10.4+git20171031.10.g9f71bb8/src/applets/budgie-menu/BudgieMenuWindow.vala
@@ -418,6 +418,7 @@ public class BudgieMenuWindow : Budgie.P
                 categories_scroll.set_visible(vis);
                 compact_mode = vis;
                 content.invalidate_headers();
+                content.invalidate_filter();
                 content.invalidate_sort();
                 break;
             case "menu-headers":
@@ -429,6 +430,7 @@ public class BudgieMenuWindow : Budgie.P
                     content.set_header_func(null);
                 }
                 content.invalidate_headers();
+                content.invalidate_filter();
                 content.invalidate_sort();
                 break;
             case "menu-categories-hover":
@@ -594,11 +596,11 @@ public class BudgieMenuWindow : Budgie.P
 
         // No more filtering, show all
         if (group == null) {
-            // Don't dupe when in "super compact" mode
-            if (super_compact && this.is_item_dupe(child)) {
-                return false;
+            if (this.headers_visible) { // If we are going to be showing headers
+                return true;
+            } else { // Not showing headers
+                return !this.is_item_dupe(child);
             }
-            return true;
         }
 
         // If the GMenu.TreeDirectory isn't the same as the current filter, hide it
